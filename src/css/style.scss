$primary:			hsl(26, 8%, 50%);
$primary-background:		hsl(60, 90%, 50%);
$secondary:			hsl(50, 26%, 50%);
$secondary-background: rgba(	hsl(120, 22%, 50%),0.15);
$highlight:			hsl(162, 70%, 50%);
$highlight-secondary:		hsl(225, 67%, 50%);

$text: darken($primary,10%);
$nav-link-visited: lighten($primary,20%);
$th-color: $primary;
$nav-link-secondary: $primary;

$background: lighten($primary-background,45%);
$nav-background: darken($primary-background,45%);
$nav-link-hover-background: darken($primary-background,35%);
$content-border: darken($primary-background,35%);
$nav-li-border: darken($primary-background,25%);
$nav-border: darken($primary-background,5%);

$horiz-line: darken($secondary,35%);

$hidestache-background: lighten($secondary-background,40%);

$link: darken($highlight,30%);
$capricon-result: darken($highlight, 40%);

$capricon-stache-background: lighten($highlight-secondary,35%);
$capricon-stache-border: lighten($highlight-secondary,25%);

$break-wide: 1280px;

$base-font-size: 112.5; // Is used as %
$line-height: 1.5; // = 27px

$base: 16 * ($base-font-size / 100);
$leading: $base * $line-height;

@mixin margin-bottom($number){
  margin-bottom: #{$number * $leading + 'px'};
  margin-bottom: #{$number * $line-height + 'rem'};
}

button {
    padding: 0.2em 0.5em;
    font-weight: bold;
    display: inline-block;
    border: outset 1px darken($secondary,30%);
    border-radius: 0.2em;
    background: rgba(lighten($secondary-background,25%),1);
    &:hover {
	background: rgba(lighten($secondary-background,20%),1);
    }
    &:active {
	border-style: inset;
	background: rgba(lighten($secondary-background,15%),1);
    }
}

h2 { width: 95%; } h3 { width: 90%; }
h1, h2, h3 {
    border-bottom: 0.08em solid rgba($horiz-line,0.5);
}

hr {
    color: $horiz-line;
    background-color: $horiz-line;
    border: none;
    height: 2px;
}

code {
    font-size: 0.85em;
    font-family: monospace;
    background-color: $secondary-background;
    padding: 0em 0.2em;
    border-radius: 3px;
}

pre {
    font-family: monospace;
    line-height: 1.2;
    overflow-x: auto;
    background-color: $secondary-background;
    padding: 0.2em;
    border-radius: 3px;
    & code { padding: 0; }
}

a {
    color: $link;
    &:active, &:focus { padding: 0.1em; outline: 0; background: rgba(255,255,255,0.2); }
}

.capricon-hide {
    display:none;

    & + .capricon-hideparagraph {
	&::before {
	    content: "Show Steps";
	    opacity: 0.7;
	    display: block;
	    width: 95%;
	    margin: auto;
	    margin-top: 1em;
	    border-bottom: 1px solid black;
	}
	&:hover::before {
	    background-color: $secondary-background;
	    font-weight: bold;
	}

	& + .capricon-reveal {
	    transition: visibility 0.2s, height 0.5s;
	    visibility: visible;
	    width: 95%; margin: auto;
	    overflow: hidden;
	    display: block;

	    &[data-linecount] { height: 16em; .capricon { height: 12em; } }
	    &[data-linecount = '1'] { height: calc(4em + 1 * 1.2em); .capricon { height: calc(1 * 1.2em); } }
	    &[data-linecount = '2'] { height: calc(4em + 2 * 1.2em); .capricon { height: calc(2 * 1.2em); } }
	    &[data-linecount = '3'] { height: calc(4em + 3 * 1.2em); .capricon { height: calc(3 * 1.2em); } }
	    &[data-linecount = '4'] { height: calc(4em + 4 * 1.2em); .capricon { height: calc(4 * 1.2em); } }
	    &[data-linecount = '5'] { height: calc(4em + 5 * 1.2em); .capricon { height: calc(5 * 1.2em); } }
	    &[data-linecount = '6'] { height: calc(4em + 6 * 1.2em); .capricon { height: calc(6 * 1.2em); } }
	    &[data-linecount = '7'] { height: calc(4em + 7 * 1.2em); .capricon { height: calc(7 * 1.2em); } }
	    &[data-linecount = '8'] { height: calc(4em + 8 * 1.2em); .capricon { height: calc(8 * 1.2em); } }
	    &[data-linecount = '9'] { height: calc(4em + 9 * 1.2em); .capricon { height: calc(9 * 1.2em); } }
	    
	    .capricon {
		overflow: auto;
		margin-bottom: 0;
	    }
	    .user-input * {
		height: 100%;
		display: none;
	    }
	    .user-input .capricon-trigger { display: block; }
	}
    }
    & + .capricon-hidestache {
	&:hover::before {
	    background-color: $hidestache-background;
	    border: 1px solid black;
    	}
	& + .capricon-reveal {
	    position: fixed; display: inline-block;
	    background: rgba(255,255,255,0.2);
	    top: 0; right: 0; bottom: 0; left: 0; margin: 0;
	    z-index: 3;
	    text-align: center;

	    .capricon {
		position: relative;
		top: 45%;
		background: $capricon-stache-background;
		border: 2px outset $capricon-stache-border;
		display: inline-block;
		padding: 0.4em 1em;
		border-radius: 3px;
		text-align: left;
	    }
	}
    }
    &:checked + .capricon-hideparagraph + .capricon-reveal {
	visibility: hidden; height: 0;
	.capricon { overflow: hidden; }
    }
    &:checked + .capricon-hidestache + .capricon-reveal {
	display: none;
    }
}
.capricon-result {
    display: inline;
    font-style: italic;
    color: $capricon-result;
}
.capricon-paragraphresult {
    display: block;
    margin-bottom: 1em;
}


html {
    display: block; height: calc(100%);
    background-image: radial-gradient(circle closest-side at center,darken($background,85%),darken($background,90%));
}

body {
    font-family: sans-serif;
    margin: auto;
    height: 100%;
    line-height: 1.6;
    font-size: 18px;
    color: darken($text,30%);
    position: relative;

    @media (min-width: $break-wide) {
	width: 70%;
    	&::before {
	    content: "";
	    background-image: url(math-tile.jpg);
	    background-size: 150%;
	    opacity: 0.1;
	    position: absolute;
	    width: 21%; 
	    right: 100%; top: 0; bottom: 0;
	}
	&::after {
	    content: "";
	    background-image: url(math-tile.jpg);
	    background-size: 150%;
	    opacity: 0.1;
	    position: absolute;
	    width: 21%; 
	    left: 100%; top: 0; bottom: 0;
	}
    }
}

nav.nav {
    border-bottom: 1px outset $nav-border; 
    ul, li {
	margin: 0; padding: 0; background: $nav-background;
	z-index: 2;
    }
    a {
	display: block;
	width: calc(100% - 1em);
	padding: 0.2em 0.5em; 
	text-decoration: none;
	&, &:visited { color: $nav-link-visited; }
	&:hover {
	    text-decoration: underline;
	    background: $nav-link-hover-background;
	}
    }
    li {
	border-bottom: 1px outset $nav-li-border; 
	position: relative; list-style-type: none; border-collapse: true; text-align: center; }
    & > ul > li {
	display: inline-block; width: 100%;
	ul {
	    display: none;
	    position: absolute;
	    left: 100%; top: -1px;
	}
	& > ul { left: -1px; top: 100%; }
    }
    li:hover > ul {
	display: block;
	width: calc(100% + 2px);
    }
}
#nav-title {
    position: relative; width: 70%;
    & > ul { width: 50%; li { text-align: left; } }
    &:hover > ul { width: calc(50% + 2px); } 
}
#nav-head { text-align: left; width: 15%; }
#page-source {
    width: 15%; text-align: right;
}    
#nav-head, #page-source { a { color: $nav-link-secondary; } }

#content-frame {
    position: relative;
    height: calc(100% - 2.25em - 2px); 
    padding: 0 0 0 1em;
    border-left: 2px outset $content-border;
    border-right: 2px outset $content-border;
}

#content-scroll {
    height: 100%; 
    overflow: auto;
    &:active, &:focus { outline: none; }
}
#content {
    padding: 0 1em 5em 1em;
    min-height: calc(100% - 6em);
    position: relative;
}
#content-scroll, #content-frame { overflow-x: visible; }

#capricon-console {
    .capricon-steps {
	display: none;
	border: none;
	border-radius: 0.2em;

	&.active {
	    display: block;
	    background: rgba(lighten($secondary-background,40%),0.9);
	    
	    h3 { margin: 0 0 1em 0; display: block; width: calc(100% - 2em); border-bottom: 1px solid;
		 padding: 0.3em 1em;
		 position: relative;
		 background: darken($primary-background,40%);
		 color: lighten($primary,30%);
		 button { text-align: right; position: absolute; right: 0.3em; top: 0.3em; } }
	    
	    .capricon-trigger { display: none; }
	    .capricon-output { display: block; max-height: 15em; overflow: auto; }
	    .capricon-input-prefix { display: inline-block; text-align: right; width: 50%; }
	    .capricon-input {
		display: inline-block; width: 45%; margin: 0;
	    }
	    .capricon-submit { display: inline-block; margin: 0; }
	}
    }
    h3 { margin: 0 0 1em 0; display: block; width: 100%; border-radius: 0.2em 0.2em 0 0; }
    
    position: fixed;
    top: 3em;
    left: 10%; width: 80%;
    @media (min-width: $break-wide) {
	left: 20%; width: 60%;	
    }
}

#footer {
    &::before {
	content: "";
	display: block; width: 90%; margin: auto;
	border-bottom: 1px solid black;
    }
    text-align: center;
    font-size: small;
    position: absolute; bottom: 0; width: 80%; margin-left: 8%;
}


