<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Marc Coiffier" />
  <title>The CaPriCon Scripting Language Reference</title>
  <style type="text/css">
    code{white-space: pre;}
    #capricon-prelude { display: none; }
    .capricon-output { display: inline-block; }
    .capricon-hide + .capricon-hidestache::before {
	content: "";
	width: 0.5em; height: 0.5em; display: inline-block;
	position: relative; bottom: 0.3em;
	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAgCAQAAABNlRuNAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfiCR0AADLw7KyaAAAB3UlEQVQ4y43UPUhVYRzH8c99scTMLAkkySx0MNOipfeW2iqa2xrEGgIpjQY3l4YwIxJ6gbaWpIZAC1oaggoiJKgsjODSGxJBwaUyb09Dp8O9ei6c3/Q8P/j+n//bORnptUm/4Gw+NdDpsl1KPqYF6twQBMHtbEpkr0PRqZivEnOfRhO+RveMw5aDec+SgHojiuYNxk7egBl/BG/1JCH95v5lbUmZ2+6UR4blFgPtpv8XGiNtOmXRpCHpjRMREJyLnJwxBVfsVqVZQ74LgqKDkdMavTuuNhmpt981H0xqjJz1ZgQlfdVG1oisHp2xl3PMQ6OakpFeD5y0YYGb0aCmWlL3BMFdq1RVZQ/qrAHvfJNSeUM+eWxr7DRoSRpeuWp1aYlv20166UjaF+kyFVVWlw5Y6nq0BU+sTC6/RlNF1lvi6X/xMwlpdcF9x8tC7LA6Oj31Y3ESTW4Jgueayyo5741g1rakvAeUBEFBR4XfbtBAxVcTqSXqTPAiGiUb9euWJXnhD/gVITfjiMOCgtG4ngXlTxszI5h3xxxYZifW2iNTfQodTrsYr3eNq4LfZT+MCjU7qluGivVe54w+K5KRXkUFl7RJrXFB8NnmtEDWeyVMeJUWyXmtZMqI2bTIX4FHiXN3BEaSAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA5LTI4VDIzOjM0OjE0KzAyOjAw5BdphAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wOS0yOFQyMjowMDo1MCswMjowMKjQ5C8AAAAASUVORK5CYII=);
	background-size: 100% 100%;
	background-repeat: none;
	padding: 0.2em;
	border: 1px solid rgba(255,255,255,0);
    }
  </style>
  <noscript>
    <style>.interactive { display: none !important; }</style>
  </noscript>
  <link rel="stylesheet" href="style.css" />
  <script src="mathjax/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
  <link rel="icon" type="image/png" href="favicon.png" />
  <!-- <script src="WiQEE.js"></script> -->
  <script src="WiQEE.js"></script>
  <script src="theme-tweak.js"></script>
</head>
<body class="ground-light primary">
<div id="content-frame" class="frame"><div class="nav header reverse">
    <span class="menu left"><a href="index.html">WiQEE</a><ul>
  	<li><a href="#">Documentation</a><ul>
	    <li><a href="lexicon.html">Lexicon</a></li>
  	    <li><a href="capricon-tutorial.html">Tutorial</a></li>
	</ul></li>
	<li><a href="#" onclick="document.getElementById('body-theme-chooser').classList.toggle('active')">Tweak theme</a></li>
    </ul></span><span class="menu middle"><a class="#">The CaPriCon Scripting Language Reference</a>
            <ul>
      <li><a href="#stack-manipulation">Stack manipulation</a></li>
      <li><a href="#names-and-variables">Names and variables</a></li>
      <li><a href="#first-class-functions">First-class functions</a></li>
      <li><a href="#lists">Lists</a></li>
      <li><a href="#simple-integer-arithmetic">Simple integer arithmetic</a></li>
      <li><a href="#strings">Strings</a></li>
      <li><a href="#interacting-with-the-environment">Interacting with the environment</a></li>
      <li><a href="#string-indexed-dictionaries">String-Indexed Dictionaries</a></li>
      <li><a href="#constructing-typed-terms">Constructing typed terms</a></li>
      <li><a href="#analysing-typed-terms">Analysing typed terms</a></li>
      <li><a href="#managing-the-type-context">Managing the type context</a></li>
      </ul>
          </span><span class="menu right"><a href="lexicon.md">Page source</a><ul>
	<li><a href="https://github.com/lih/WiQEE-pages/edit/master/lexicon.md">Edit</a></li>
	<li><a href="lexicon.pdf">PDF version</a></li>
      </ul></span>
  </div><div id="content-scroll"><div id="content" class="sheet" tabindex="1">
      <h1>The CaPriCon Scripting Language Reference</h1>
<p>All the basic words are described below.</p>
<h2 id="stack-manipulation">Stack manipulation</h2>
<p>The environment of the interpreter consists mostly of a stack of values, that can be manipulated with the following words.</p>
<dl>
<dt><code>dup</code> / <code>dupn</code></dt>
<dd><p>Duplicates the top element, or the nth top element of the stack.</p>
<ul>
<li><code>dup</code> : <span class="math inline">\(x\ ...\ \rightarrow\ x\ x\ ...\)</span><br />
</li>
<li><code>dupn</code> : <span class="math inline">\(n\ x_0 .. x_n\ ...\ \rightarrow\ x_n\ x_0 .. x_n\ ...\)</span></li>
</ul>
</dd>
<dt><code>swap</code> / <code>swapn</code></dt>
<dd><p>Swaps the top element of the stack with the second, or the nth element.</p>
<ul>
<li><code>swap</code> : <span class="math inline">\(x\ y\ ...\ \rightarrow\ y\ x\ ...\)</span><br />
</li>
<li><code>swapn</code> : <span class="math inline">\(n\ x\ y_0 .. y_n\ ...\ \rightarrow\ y_n\ y_0 .. y_{n-1}\ x\ ...\)</span></li>
</ul>
</dd>
<dt><code>shift</code> / <code>shaft</code></dt>
<dd><p>Shifts the nth element towards the top, or shaft the top to the nth place.</p>
<ul>
<li><code>shift</code> : <span class="math inline">\(n\ x_1..x_n\ ...\ \rightarrow\ x_n\ x_1..x_{n-1}\ ...\)</span><br />
</li>
<li><code>shaft</code> : <span class="math inline">\(n\ x_1..x_n\ ...\ \rightarrow\ x_2..x_n\ x_1...\)</span></li>
</ul>
</dd>
<dt><code>pop</code> / <code>popn</code></dt>
<dd><p>Pops the top element, or the nth top element, off the stack.</p>
<ul>
<li><code>pop</code> : <span class="math inline">\(x\ ...\ \rightarrow\ ...\)</span><br />
</li>
<li><code>popn</code> : <span class="math inline">\(n\ x_0..x_n\ ...\ \rightarrow\ x_0..x_{n-1}\ ...\)</span></li>
</ul>
</dd>
<dt><code>clear</code></dt>
<dd><p>Clears the stack.</p>
<ul>
<li><code>clear</code> : <span class="math inline">\(...\ \rightarrow\ \)</span></li>
</ul>
</dd>
<dt><code>stack</code> / <code>set-stack</code></dt>
<dd><p>Pushes the current stack, as a list, on top of the current stack. In the second case, sets the top element of the stack as the new stack.</p>
<ul>
<li><code>stack</code> : <span class="math inline">\(Stack\ \rightarrow\ [Stack] Stack\)</span></li>
<li><code>set-stack</code> : <span class="math inline">\([Stack] ...\ \rightarrow\ Stack\)</span></li>
</ul>
</dd>
<dt><code>pick</code></dt>
<dd><p>Picks the i-between-nth element of the stack, and discards all others. Can be useful for implementing arbitrary switch-like control-flow.</p>
<ul>
<li><code>pick</code> : <span class="math inline">\(i\ n\ x_0..x_i..x_{n-1}\ ...\ \rightarrow\ x_i\ ...\)</span></li>
</ul>
</dd>
</dl>
<h2 id="names-and-variables">Names and variables</h2>
<dl>
<dt><code>def</code></dt>
<dd><p>Sets the value of a variable.</p>
<ul>
<li><code>def</code> : <span class="math inline">\(value\ name\ ... \rightarrow ...\)</span> in an environment where <span class="math inline">\(value\)</span> is associated with the variable named <span class="math inline">\(name\)</span>.</li>
</ul>
<p>Examples :</p>
<label class="expansible box"><input type="checkbox" checked="checked" /><span class="expand-else capricon-show"></span><span class="expand-then capricon-hide"></span><span class="expand-then" style="--num-lines: 3.25">
<div class="capricon-steps">
<pre class="capricon capricon-paragraph capricon-context"><span class="symbol" data-symbol-name="'x">'x</span> <span class="symbol" data-symbol-name="3">3</span> <span class="symbol" data-symbol-name="def">def</span> <span class="symbol" data-symbol-name="'y">'y</span> <span class="symbol" data-symbol-name="7">7</span> <span class="symbol" data-symbol-name="def">def</span>
<span class="symbol" data-symbol-name="x">x</span> <span class="symbol" data-symbol-name="y">y</span> <span class="symbol" data-symbol-name="x">x</span> <span class="symbol" data-symbol-name="y">y</span> <span class="symbol" data-symbol-name="+">+</span> <span class="symbol" data-symbol-name="y">y</span> <span class="symbol" data-symbol-name="*">*</span> <span class="symbol" data-symbol-name="&quot;(x + y) * y = %v; y = %v ; x = %v&quot;">&quot;(x + y) * y = %v; y = %v ; x = %v&quot;</span> <span class="symbol" data-symbol-name="printf">printf</span></pre>
<div class="user-input interactive">
<button class="capricon-trigger">
Try It Out
</button>
<label class="capricon-input-prefix">&gt; <input type="text" class="capricon-input" /></label>
<pre class="capricon-output"></pre>
</div>
</div>
</span></label>
<div class="capricon-paragraphresult">
(x + y) * y = 70; y = 7 ; x = 3
</div>
</dd>
<dt><code>$</code></dt>
<dd><p>The inverse of <code>def</code>. Given the name of a variable at the top of the stack, this function produces the value of the corresponding variable in the current environment.</p>
<ul>
<li><code>$</code> : <span class="math inline">\(name\ ...\ \rightarrow\ \$name\ ...\)</span></li>
</ul>
</dd>
<dt><code>vocabulary</code> / <code>set-vocabulary</code></dt>
<dd><p>Pushes the active dictionary, that contains all defined variables, on top of the stack. In the second case, make the top of the stack the current dictionary, redefining all variables at once.</p>
</dd>
<dt><code>lookup</code></dt>
<dd><p>A more flexible version of <code>$</code>, where the environment is specified explicitly as a second argument (for example, from calling <code>vocabulary</code>).</p>
</dd>
</dl>
<h2 id="first-class-functions">First-class functions</h2>
<dl>
<dt><code>exec</code></dt>
<dd><p>Executes the value at the top of the stack, as if it were the meaning of a word. To illustrate, given a function, <code>'f $ exec</code> is equivalent to <code>f</code> itself. That is, evaluating a symbol is no different than looking it up in the current dictionary, and <code>exec</code>uting its value.</p>
</dd>
</dl>
<h2 id="lists">Lists</h2>
<dl>
<dt><code>[</code></dt>
<dd><p>Puts a “list beginning” (LB) marker on the stack</p>
<ul>
<li><code>[</code> : <span class="math inline">\(...\ \rightarrow\ LB\ ...\)</span></li>
</ul>
</dd>
<dt><code>]</code></dt>
<dd><p>Creates a list of the elements on the stack until the next “list beginning” marker, and pushes it on the remaining stack.</p>
<ul>
<li><code>]</code> : <span class="math inline">\(x_0..x_n\ LB\ ...\ \rightarrow\ [x_n..x_0]\ ...\)</span></li>
</ul>
</dd>
<dt><code>each</code></dt>
<dd><p>Iterates over each element of its second argument, pushing it on the stack and running its second argument afterward.</p>
<p>Examples :</p>
<label class="expansible box"><input type="checkbox" checked="checked" /><span class="expand-else capricon-show"></span><span class="expand-then capricon-hide"></span><span class="expand-then" style="--num-lines: 2.25">
<div class="capricon-steps">
<pre class="capricon capricon-paragraph capricon-context"><span class="symbol" data-symbol-name="&quot;Values: &quot;">&quot;Values: &quot;</span> <span class="symbol" data-symbol-name="print">print</span> <span class="symbol" data-symbol-name="[">[</span> <span class="symbol" data-symbol-name="1">1</span> <span class="symbol" data-symbol-name="2">2</span> <span class="symbol" data-symbol-name="3">3</span> <span class="symbol" data-symbol-name="]">]</span> <span class="quote quote-brace"><span class="symbol" data-symbol-name="{">{</span> <span class="symbol" data-symbol-name="show">show</span> <span class="symbol" data-symbol-name="pop">pop</span> <span class="symbol" data-symbol-name="}">}</span></span> <span class="symbol" data-symbol-name="each">each</span></pre>
<div class="user-input interactive">
<button class="capricon-trigger">
Try It Out
</button>
<label class="capricon-input-prefix">&gt; <input type="text" class="capricon-input" /></label>
<pre class="capricon-output"></pre>
</div>
</div>
</span></label>
<div class="capricon-paragraphresult">
<p>Values: 1 2 3</p>
</div>
</dd>
<dt><code>range</code></dt>
<dd><p>Create a list of numbers from 0 to <span class="math inline">\(n-1\)</span>, <span class="math inline">\(n\)</span> being the top element of the stack.</p>
<ul>
<li><code>range</code> : <span class="math inline">\(n\ ...\ \rightarrow\ [0..n-1]\ ...\)</span></li>
</ul>
</dd>
</dl>
<h2 id="simple-integer-arithmetic">Simple integer arithmetic</h2>
<dl>
<dt><code>+</code>, <code>-</code>, <code>*</code>, <code>div</code>, <code>mod</code></dt>
<dd><p>Performs the usual binary arithmetic operation on the top two elements of the stack, and replaces them with the result.</p>
</dd>
<dt><code>sign</code></dt>
<dd><p>Computes the sign of the top stack element. If the sign is negative, produces <span class="math inline">\(-1\)</span>, if positive produces <span class="math inline">\(1\)</span>, otherwise produces <span class="math inline">\(0\)</span>.</p>
</dd>
</dl>
<h2 id="strings">Strings</h2>
<dl>
<dt><code>format</code></dt>
<dd><p>Much like the <code>sprintf()</code> function in C, produces a string which may contain textual representations of various other values.</p>
<p>Examples :</p>
<label class="expansible box"><input type="checkbox" checked="checked" /><span class="expand-else capricon-show"></span><span class="expand-then capricon-hide"></span><span class="expand-then" style="--num-lines: 2.25">
<div class="capricon-steps">
<pre class="capricon capricon-paragraph capricon-context"><span class="symbol" data-symbol-name="&quot;Some text&quot;">&quot;Some text&quot;</span> <span class="symbol" data-symbol-name="1">1</span> <span class="symbol" data-symbol-name="&quot;&lt;p&gt;%v: %s&lt;/p&gt;&quot;">&quot;&lt;p&gt;%v: %s&lt;/p&gt;&quot;</span> <span class="symbol" data-symbol-name="format">format</span> <span class="symbol" data-symbol-name="show">show</span></pre>
<div class="user-input interactive">
<button class="capricon-trigger">
Try It Out
</button>
<label class="capricon-input-prefix">&gt; <input type="text" class="capricon-input" /></label>
<pre class="capricon-output"></pre>
</div>
</div>
</span></label>
<div class="capricon-paragraphresult">
"
<p>
1: Some text
</p>
<p>"</p>
</div>
</dd>
<dt><code>to-int</code></dt>
<dd><p>Tries to convert the top stack element to an integer, if possible.</p>
</dd>
</dl>
<h2 id="interacting-with-the-environment">Interacting with the environment</h2>
<dl>
<dt><code>exit</code></dt>
<dd><p>Exits the interpreter, immediately and unconditionally.</p>
</dd>
<dt><code>print</code></dt>
<dd><p>Print the string at the top of the stack into the current document.</p>
</dd>
<dt><code>source</code></dt>
<dd><p>Opens an external source file, and pushes a quote on the stack with its contents.</p>
</dd>
<dt><code>cache</code></dt>
<dd><p>Given a resource name and a quote, does one of two things :</p>
<ul>
<li>if the resource already exists, try to open it as a CaPriCon object, ignoring the quote</li>
<li>otherwise, run the quote and store its result in the resource for future use</li>
</ul>
<p>After the builtin has run, the contents of the requested object can be found at the top of the stack.</p>
</dd>
<dt><code>redirect</code></dt>
<dd><p>Given a resource name and a quote, executes the quote, redirecting its output to the resource.</p>
</dd>
</dl>
<h2 id="string-indexed-dictionaries">String-Indexed Dictionaries</h2>
<dl>
<dt><code>empty</code></dt>
<dd><p>Pushes the empty dictionary onto the stack.</p>
</dd>
<dt><code>insert</code></dt>
<dd><p>Given a dictionary <code>d</code>, a key <code>k</code> and a value <code>v</code>, inserts the value <code>v</code> at <code>k</code> in <code>d</code>, then pushes the result on the stack.</p>
</dd>
<dt><code>delete</code></dt>
<dd><p>The reverse of <code>insert</code>. Given a dictionary <code>d</code> and a key <code>k</code>, produce a dictionary <code>d'</code> that is identical to <code>d</code>, without any association for <code>k</code>.</p>
</dd>
<dt><code>keys</code></dt>
<dd><p>Given a dictionary <code>d</code>, pushes a list of all of <code>d</code>’s keys onto the stack.</p>
</dd>
</dl>
<h2 id="constructing-typed-terms">Constructing typed terms</h2>
<dl>
<dt><code>universe</code></dt>
<dd><p>Produces a universe.</p>
<ul>
<li><code>universe</code> : <span class="math inline">\(i\ ...\ \rightarrow\ Set_i\ ...\)</span></li>
</ul>
</dd>
<dt><code>variable</code></dt>
<dd><p>Given a variable name, that exists in the current type context, produces that variable.</p>
<ul>
<li><code>variable</code> : <span class="math inline">\(name\ ...\ \rightarrow\ var(name)\ ...\)</span></li>
</ul>
</dd>
<dt><code>apply</code></dt>
<dd><p>Given a function <code>f</code>, and a term <code>x</code>, produces the term <code>f x</code>.</p>
<ul>
<li><code>apply</code> : <span class="math inline">\(x\ f\ ...\ \rightarrow\ (f\ x)\ ...\)</span></li>
</ul>
</dd>
<dt><code>lambda</code> / <code>forall</code></dt>
<dd><p>Abstracts the last hypothesis in context for the term at the top of the stack. That hypothesis is abstracted repectively as a lambda-abstraction, or a product.</p>
<ul>
<li><code>lambda</code> : <span class="math inline">\((\Gamma, h : T_h \vdash x)\ ... \rightarrow (\Gamma \vdash (\lambda (h : T_h). x))\ ...\)</span><br />
</li>
<li><code>forall</code> : <span class="math inline">\((\Gamma, h : T_h \vdash x)\ ... \rightarrow (\Gamma \vdash (\forall (h : T_h), x))\ ...\)</span></li>
</ul>
</dd>
<dt><code>mu</code></dt>
<dd><p>Produces an inductive projection to a higher universe for the term at the top of the stack, if that term is of an inductive type.</p>
<ul>
<li><code>mu</code> : <span class="math inline">\(x\ ...\ \rightarrow\ \mu(x)\ ...\)</span></li>
</ul>
</dd>
<dt><code>axiom</code></dt>
<dd><p>Given a combinatorial type (a type without free variables) and an associated tag, produce an axiom with that tag, that can serve as a proof of the given type.</p>
<ul>
<li><code>axiom</code> : <span class="math inline">\(tag\ T\ ...\ \rightarrow\ Axiom_{T,tag}\ ...\)</span></li>
</ul>
</dd>
</dl>
<h2 id="analysing-typed-terms">Analysing typed terms</h2>
<dl>
<dt><code>type</code></dt>
<dd><p>Computes the type of the term at the top of the stack.</p>
</dd>
<dt><code>match</code></dt>
<dd><p>Given a quote for each possible shape, and a term, executes the corresponding quote :</p>
<ul>
<li><span class="math inline">\(k_{Set}\ k_{\lambda}\ k_{\forall}\ k_{apply}\ k_{\mu}\ k_{var}\ k_{axiom}\)</span> <code>match</code> :<br />
</li>
<li><span class="math inline">\(|\ \Gamma \vdash (\lambda (x : T_x). y)\ ...\ \rightarrow\ k_{\lambda}(\Gamma, x : T_x \vdash\ x\ y\ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ \Gamma \vdash (\forall (x : T_x). y)\ ...\ \rightarrow\ k_{\forall}(\Gamma, x : T_x \vdash\ x\ y\ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ (f x_1..x_n)\ ...\ \rightarrow\ k_{apply}([x_1..x_n]\ f\ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ \mu(x)\ ...\ \rightarrow\ k_{\mu}(x\ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ x\ ...\ \rightarrow\ k_{var}(name(x)\ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ Axiom_{T,tag}\ ...\ \rightarrow\ k_{axiom}(tag\ T\ \ ...)\)</span><br />
</li>
<li><span class="math inline">\(|\ Set_n\ ...\ \rightarrow\ k_{Set}(n\ \ ...)\)</span></li>
</ul>
</dd>
<dt><code>extract</code></dt>
<dd><p>Extract the term at the top of the stack into an abstract algebraic representation, suitable for the production of foreign functional code, such as OCaml or Haskell.</p>
</dd>
</dl>
<h2 id="managing-the-type-context">Managing the type context</h2>
<dl>
<dt><code>intro</code></dt>
<dd><p>Given a type <span class="math inline">\(T\)</span> and a name <span class="math inline">\(H\)</span>, adds a new hypothesis <span class="math inline">\(H\)</span> of type <span class="math inline">\(T\)</span> to the context. Alternately, you can give a second hypothesis name <span class="math inline">\(H&#39;\)</span>, in which case the new hypothesis will be introduced before <span class="math inline">\(H&#39;\)</span>.</p>
<p><code>intro</code> :<br />
- <span class="math inline">\(|\ \Gamma \vdash name(H)\ T\ ...\ \rightarrow \Gamma, H : T \vdash\ ...\)</span><br />
- <span class="math inline">\(|\ \Gamma,H&#39; : T_{H&#39;},\Delta \vdash name(H&#39;)\ name(H)\ T\ ...\ \rightarrow \Gamma, H : T,H&#39; : T_{H&#39;},\Delta \vdash\ ...\)</span></p>
</dd>
<dt><code>extro-lambda</code> / <code>extro-forall</code></dt>
<dd><p>Clears the last hypothesis from the context. Every term that references that hypothesis is abstracted either as a lambda-expression, or as a product, depending on the variant that was called.</p>
</dd>
<dt><code>rename</code></dt>
<dd><p>Renames a hypothesis. This function takes two parameters : a hypothesis name, and the new name to give it.</p>
</dd>
<dt><code>substitute</code></dt>
<dd><p>Given a hypothesis name, and a term of the same type as that hypothesis, remove that hypothesis from the context by substituting all its occurences by the given term.</p>
</dd>
<dt><code>hypotheses</code></dt>
<dd><p>Pushes a list of all the hypotheses’ names in context, from most recent to the oldest.</p>
</dd>
</dl>
      <div id="footer">Page generated on Thursday, April 11 of 2019, at 21:22 PM UTC, using capricon-0.13 and pandoc-2.7.2.</div>
</div></div></div>
<script id="capricon-prelude" type="text/plain">'nop { { } } def 'get { nop nop lookup } def  'each list 1 dupn get def 'dict-keys dict 'keys get def 'import-keys {   { 1 dupn 1 dupn get def } each   pop } def  'import {   dup dict-keys import-keys  } def  [ dict term-index construction query context io list arith string ] { import } each  'printf { format print pop } def 'show { "%v\n" printf } def 'show-stack { stack { show } each } def 'times { range { pop dup exec } each pop } def 'reverse { [ ] swap { cons } each } def  'eol. { } def 'mustache. { show } def 'tex { 'mustache. { "$%l$\n" printf 'mustache. ,{ dup $ } def } def } def 'svg { 'mustache. { "<svg class='capricon-formula' width='150px' height='2em' viewBox='0 0 100 100' xmlns=\"http://www.w3.org/2000/svg\"><text class='formula-text' x='0' y='100'>%g</text></svg>" printf 'mustache. ,{ dup $ } def } def } def 'raw { 'mustache. { "%s\n" printf 'mustache. ,{ dup $ } def } def } def 'br { "<br/>" print } def  'collect { { 'exports empty def ${ } exports { ,{ ,{ vocabulary } } set-vocabulary ,{ ,{ stack } } set-stack ,{ exports } } exec } exec } def 'exports empty def 'export { exports swap dup $ insert 'exports swap def } def  [ 'source-dir 'output-dir 'cache-dir ] { "" def } each  'module { source-dir "%s%s" format source exec } def 'require { dup dup "  * Required module: [%s][:%s]\n" printf { ,{ dup } { module } collect } swap cache-dir "%s%s.mdo" format cache } def   </script>
<div id="capricon-console"></div>
<script type="text/javascript">
  window.addEventListener("load",function() {
      var formulae = document.getElementsByClassName('capricon-formula');
      for(var i = 0; i < formulae.length; i++) {
	  var formula = formulae.item(i);
	  var box = formula.getBBox();
	  var w = Math.ceil(box.width)*1.05; h = Math.ceil(box.height)*1.05;
	  var x = Math.floor(box.x), y = Math.floor(box.y);
	  
	  formula.setAttribute("viewBox", x+" "+y+" "+w+" "+h);
	  formula.setAttribute("width", w);
	  formula.setAttribute("height", h);
      }
  });
</script>
<div id="body-theme-chooser" style="z-index: 100; position: fixed; text-align: right; left: 0; bottom: 0; font-size: 1rem !important" class="opaque frame level-12">
  <div class="sheet">
    <script>
      document.addEventListener('DOMContentLoaded',function() {
	  Theme.attach(document.getElementsByTagName('body')[0]);
      });
    </script>
    <label>Ambiance: <select class="theme-ambiance-select">
	<option value="day" selected="selected">Day</option>
	<option value="night">Night</option>
      </select>
    </label>
    <style>.theme-prop-display { min-width: 4em; display: inline-block; }</style>
    <label class="theme-slider" style="display: block">Primary hue<input type="range" min="0" max="360" value="180"/><span class="theme-prop-display" data-prop-name="--prim-hue"></span></label>	
    <label class="theme-slider" style="display: block">Primary saturation<input type="range" min="0" max="100" value="50" /><span class="theme-prop-display" data-prop-name="--prim-saturation"></span></label>
    <label class="theme-slider" style="display: block">Low hue<input type="range" min="-180" max="180" value="0"/><span class="theme-prop-display" data-prop-name="--low-hue"></span></label>	
    <label class="theme-slider" style="display: block">Low saturation<input type="range" min="0" max="100" value="50"/><span class="theme-prop-display" data-prop-name="--low-saturation"></span></label>
    <label class="theme-slider" style="display: block">High hue<input type="range" min="-180" max="180" value="0"/><span class="theme-prop-display" data-prop-name="--high-hue"></span></label>	
    <label class="theme-slider" style="display: block">High saturation<input type="range" min="0" max="100" value="50"/><span class="theme-prop-display" data-prop-name="--high-saturation"></span></label>
    <label class="theme-slider" style="display: block">Min contrast<input type="range" min="10" max="100" value="50" /><span class="theme-prop-display" data-prop-name="--min-contrast"></span></label>
    <label class="theme-slider" style="display: block">Max contrast<input type="range" min="10" max="100" value="0" /><span class="theme-prop-display" data-prop-name="--max-contrast"></span></label>
    <label class="theme-slider" style="display: block">Luminosity<input type="range" min="0" max="100" value="180"/><span class="theme-prop-display" data-prop-name="--luminosity"></span></label>
    <button onclick="document.getElementById('body-theme-chooser').classList.toggle('active')">Close</button>
  </div>
</div>
</body>
</html>
